{
    "name": "AKI-SPAWN-SpecialistAgent",
    "nodes": [
          {
                  "parameters": {
                            "httpMethod": "POST",
                            "path": "aki-spawn-specialist",
                            "responseMode": "responseNode",
                            "options": {}
                  },
                  "id": "spawn-webhook",
                  "name": "Spawn Request",
                  "type": "n8n-nodes-base.webhook",
                  "position": [250, 300],
                  "webhookId": "aki-spawn-specialist"
          },
          {
                  "parameters": {
                            "jsCode": "const request = $input.first().json.body || $input.first().json;\nconst templates = {\n  'web-scraper': { model: 'claude-3-haiku-20240307', system_prompt: 'You are a web scraping specialist.' },\n  'news-analyzer': { model: 'claude-sonnet-4-20250514', system_prompt: 'You are a news analysis specialist.' },\n  'code-python': { model: 'claude-sonnet-4-20250514', system_prompt: 'You are a Python coding specialist.' },\n  'data-analyst': { model: 'claude-3-haiku-20240307', system_prompt: 'You are a data analysis specialist.' }\n};\nconst specialistType = request.type || 'data-analyst';\nconst template = templates[specialistType] || templates['data-analyst'];\nconst specialistId = 'SPEC-' + specialistType.toUpperCase() + '-' + Date.now().toString(36).toUpperCase();\nreturn [{ json: { specialist_id: specialistId, type: specialistType, model: template.model, system_prompt: template.system_prompt, task: request.task || 'Analyze data', spawned_at: new Date().toISOString() } }];"
                  },
                  "id": "prepare-specialist",
                  "name": "Prepare Specialist",
                  "type": "n8n-nodes-base.code",
                  "position": [450, 300]
          },
          {
                  "parameters": {
                            "method": "POST",
                            "url": "https://api.anthropic.com/v1/messages",
                            "sendHeaders": true,
                    "headerParameters": {
                                "parameters": [
                                              { "name": "x-api-key", "value": "={{ $vars.ANTHROPIC_API_KEY }}" },
                                              { "name": "anthropic-version", "value": "2023-06-01" },
                                              { "name": "content-type", "value": "application/json" }
                                ]
                    },
                            "sendBody": true,
                            "specifyBody": "json",
                            "jsonBody": "={\n  \"model\": \"{{ $json.model }}\",\n  \"max_tokens\": 2048,\n  \"system\": \"{{ $json.system_prompt }}\",\n  \"messages\": [{ \"role\": \"user\", \"content\": \"{{ $json.task }}\" }]\n}",
                            "options": { "timeout": 60000 }
                  },
                  "id": "execute-specialist",
                  "name": "Execute Specialist Task",
                  "type": "n8n-nodes-base.httpRequest",
                  "position": [650, 300]
          },
          {
                          "parameters": {
                                    "jsCode": "const specialist = $('Prepare Specialist').first().json;\nconst response = $input.first().json;\nconst content = response.content?.[0]?.text || 'No output';\nreturn [{ json: { specialist_id: specialist.specialist_id, type: specialist.type, status: 'COMPLETED', output: content, completed_at: new Date().toISOString() } }];"
                          },
                  "id": "format-result",
                  "name": "Format Result",
                  "type": "n8n-nodes-base.code",
                  "position": [850, 300]
                          },
                        {
                          "parameters": {
                                    "respondWith": "json",
                                    "responseBody": "={{ JSON.stringify($json) }}",
                                    "options": {}
                          },
                  "id": "spawn-respond",
                                "name": "Respond",
                                "type": "n8n-nodes-base.respondToWebhook",
                                "position": [1050, 300]
                        }
    ],
    "connections": {
          "Spawn Request": { "main": [[{ "node": "Prepare Specialist", "type": "main", "index": 0 }]] },
          "Prepare Specialist": { "main": [[{ "node": "Execute Specialist Task", "type": "main", "index": 0 }]] },
          "Execute Specialist Task": { "main": [[{ "node": "Format Result", "type": "main", "index": 0 }]] },
          "Format Result": { "main": [[{ "node": "Respond", "type": "main", "index": 0 }]] }
    },
        "active": false,
              "settings": { "executionOrder": "v1" },
    "tags": [{ "name": "AKI-SPECIALIST" }]
}
