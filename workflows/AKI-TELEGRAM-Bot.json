{
    "name": "AKI-TELEGRAM-Bot",
    "nodes": [
          {
                  "parameters": {
                            "httpMethod": "POST",
                            "path": "aki-telegram-webhook",
                            "responseMode": "responseNode",
                            "options": {}
                  },
                  "id": "telegram-webhook",
                  "name": "Telegram Webhook",
                  "type": "n8n-nodes-base.webhook",
                  "position": [250, 300],
                  "webhookId": "aki-telegram-webhook"
          },
          {
                  "parameters": {
                            "jsCode": "const update = $input.first().json;\n\nconst message = update.message || update.callback_query?.message;\nconst chatId = message?.chat?.id || update.callback_query?.message?.chat?.id;\nconst text = message?.text || '';\nconst callbackData = update.callback_query?.data;\nconst userId = message?.from?.id || update.callback_query?.from?.id;\nconst username = message?.from?.username || update.callback_query?.from?.username;\n\nlet command = null;\nlet args = [];\n\nif (text.startsWith('/')) {\n  const parts = text.split(' ');\n  command = parts[0].substring(1).toLowerCase();\n  args = parts.slice(1);\n}\n\nlet responseText = '';\nlet replyMarkup = null;\n\nswitch (command) {\n  case 'start':\n    responseText = `ğŸ¢ *AKI Holdings Command Center*\\n\\nWelcome, ${username}!\\n\\nì‚¬ìš© ê°€ëŠ¥í•œ ëª…ë ¹ì–´:\\n/status - ì‹œìŠ¤í…œ ìƒíƒœ\\n/tasks - ì‘ì—… í˜„í™©\\n/trades - ìµœê·¼ ê±°ë˜\\n/approve - ìŠ¹ì¸ ëŒ€ê¸° ëª©ë¡\\n/report - ì¼ì¼ ë¦¬í¬íŠ¸\\n/help - ë„ì›€ë§`;\n    break;\n    \n  case 'status':\n    responseText = `ğŸ“Š *ì‹œìŠ¤í…œ ìƒíƒœ*\\n\\nâœ… Overall: HEALTHY\\nâ± Uptime: 47d 12h\\nğŸ‘¥ Active Agents: 47\\nğŸ’° Today Cost: $7.40\\nğŸ“ˆ Tasks Today: 104/98 completed`;\n    replyMarkup = {\n      inline_keyboard: [\n        [{ text: 'ğŸ”„ ìƒˆë¡œê³ ì¹¨', callback_data: 'refresh_status' }],\n        [{ text: 'ğŸ“‹ ìƒì„¸ë³´ê¸°', callback_data: 'detail_status' }]\n      ]\n    };\n    break;\n    \n  case 'tasks':\n    responseText = `ğŸ“‹ *ì‘ì—… í˜„í™©*\\n\\nğŸ”µ Pending: 4\\nğŸŸ¡ In Progress: 8\\nğŸŸ¢ Completed: 98\\nğŸ”´ Failed: 2\\n\\nìµœê·¼ ì‘ì—…:\\nâ€¢ RES-001: ì‹œì¥ ë¶„ì„ (ì§„í–‰ì¤‘)\\nâ€¢ DEV-001: API ê°œë°œ (ì™„ë£Œ)\\nâ€¢ QNT-001: ë¦¬ìŠ¤í¬ ê³„ì‚° (ì™„ë£Œ)`;\n    break;\n    \n  case 'trades':\n    responseText = `ğŸ’¹ *ìµœê·¼ ê±°ë˜*\\n\\nğŸ“ˆ Total PnL: +$127.50\\nğŸ“Š Win Rate: 68%\\nğŸ“‰ Trades Today: 12\\n\\nìµœê·¼ ê±°ë˜:\\nâ€¢ BTC/USDT SELL +$45.20\\nâ€¢ ETH/USDT BUY -$12.30\\nâ€¢ POLY-Market +$28.00`;\n    break;\n    \n  case 'approve':\n    responseText = `â³ *ìŠ¹ì¸ ëŒ€ê¸°*\\n\\n1. ğŸ¤– *Polymarket ë´‡ v2.3*\\n   ë¹„ìš©: $4.50 | ìš°ì„ ìˆœìœ„: HIGH\\n\\n2. ğŸ“Š *ì‹ ê·œ DeFi ì „ëµ*\\n   ë¹„ìš©: $0 | ìš°ì„ ìˆœìœ„: MEDIUM`;\n    replyMarkup = {\n      inline_keyboard: [\n        [{ text: 'âœ… ë´‡ ìŠ¹ì¸', callback_data: 'approve_bot' }, { text: 'âŒ ê±°ë¶€', callback_data: 'reject_bot' }],\n        [{ text: 'âœ… ì „ëµ ìŠ¹ì¸', callback_data: 'approve_strategy' }, { text: 'âŒ ê±°ë¶€', callback_data: 'reject_strategy' }]\n      ]\n    };\n    break;\n    \n  case 'report':\n    responseText = `ğŸ“‘ *ì¼ì¼ ë¦¬í¬íŠ¸*\\n\\nğŸ“… ${new Date().toLocaleDateString('ko-KR')}\\n\\nğŸ’° *ë¹„ìš©*\\nAPI í˜¸ì¶œ: $7.40\\nì¸í”„ë¼: $0.50\\nì´ê³„: $7.90\\n\\nğŸ“Š *ì„±ê³¼*\\nì™„ë£Œ ì‘ì—…: 98ê±´\\nì„±ê³µë¥ : 96%\\ní‰ê·  ì‘ë‹µ: 2.3ì´ˆ\\n\\nğŸ’¹ *ê±°ë˜*\\nPnL: +$127.50\\nê±°ë˜ìˆ˜: 12ê±´`;\n    break;\n    \n  case 'help':\n    responseText = `â“ *ë„ì›€ë§*\\n\\n/status - ì „ì²´ ì‹œìŠ¤í…œ ìƒíƒœ\\n/tasks - ì‘ì—… í˜„í™© ì¡°íšŒ\\n/trades - ê±°ë˜ ë‚´ì—­ ì¡°íšŒ\\n/approve - ìŠ¹ì¸ ëŒ€ê¸° í•­ëª©\\n/report - ì¼ì¼ ë¦¬í¬íŠ¸\\n/agent [id] - ì—ì´ì „íŠ¸ ìƒíƒœ\\n/execute [task] - ì‘ì—… ì‹¤í–‰\\n/stop [id] - ì‘ì—… ì¤‘ì§€`;\n    break;\n    \n  default:\n    if (callbackData) {\n      switch (callbackData) {\n        case 'refresh_status':\n          responseText = 'ğŸ”„ ìƒíƒœ ìƒˆë¡œê³ ì¹¨ ì™„ë£Œ!';\n          break;\n        case 'approve_bot':\n          responseText = 'âœ… Polymarket ë´‡ v2.3 ìŠ¹ì¸ë¨!';\n          break;\n        case 'reject_bot':\n          responseText = 'âŒ Polymarket ë´‡ v2.3 ê±°ë¶€ë¨.';\n          break;\n        default:\n          responseText = 'ì²˜ë¦¬ ì™„ë£Œ!';\n      }\n    } else if (text) {\n      responseText = `ğŸ¤– ëª…ë ¹ì–´ë¥¼ ì¸ì‹í•˜ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.\\n/help ë¥¼ ì…ë ¥í•˜ì—¬ ì‚¬ìš© ê°€ëŠ¥í•œ ëª…ë ¹ì–´ë¥¼ í™•ì¸í•˜ì„¸ìš”.`;\n    }\n}\n\nreturn [{\n  json: {\n    chat_id: chatId,\n    text: responseText,\n    parse_mode: 'Markdown',\n    reply_markup: replyMarkup,\n    original_command: command,\n    user_id: userId,\n    username: username\n  }\n}];"
                  },
                  "id": "process-telegram",
                  "name": "Process Command",
                  "type": "n8n-nodes-base.code",
                  "position": [450, 300]
          },
          {
                  "parameters": {
                            "method": "POST",
                            "url": "=https://api.telegram.org/bot{{ $vars.TELEGRAM_BOT_TOKEN }}/sendMessage",
                            "sendBody": true,
                            "specifyBody": "json",
                            "jsonBody": "={\n  \"chat_id\": {{ $json.chat_id }},\n  \"text\": \"{{ $json.text }}\",\n  \"parse_mode\": \"{{ $json.parse_mode }}\"\n}",
                    "options": {}
          },
            "id": "send-telegram",
            "name": "Send Response",
            "type": "n8n-nodes-base.httpRequest",
            "position": [650, 300]
      },
          {
                  "parameters": {
                            "respondWith": "json",
                            "responseBody": "={\"ok\": true}",
                            "options": {}
                  },
                  "id": "telegram-respond",
                  "name": "Respond OK",
                  "type": "n8n-nodes-base.respondToWebhook",
                  "position": [850, 300]
          }
    ],
    "connections": {
          "Telegram Webhook": { "main": [[{ "node": "Process Command", "type": "main", "index": 0 }]] },
          "Process Command": { "main": [[{ "node": "Send Response", "type": "main", "index": 0 }]] },
          "Send Response": { "main": [[{ "node": "Respond OK", "type": "main", "index": 0 }]] }
    },
    "active": false,
    "settings": { "executionOrder": "v1" },
    "tags": [{ "name": "AKI-TELEGRAM" }]
}
